function doPost(e) {
  try {
    var data = JSON.parse(e.postData.contents);
    var ss = SpreadsheetApp.openById("1lVQLHn6KyOINkwZ4E4VXL4vCNQPBBoB-cqt7YQY6H_4");
    var usersSheet = ss.getSheetByName("Users");
    var detailsSheet = ss.getSheetByName("UserDetails");

    // === Format DateTime ===
    var now = new Date();
    var formattedTime = Utilities.formatDate(now, Session.getScriptTimeZone(), "dd-MMM-yyyy, hh:mm a");

    // === Ensure headers exist ===
    if (usersSheet.getLastRow() === 0) {
      usersSheet.appendRow(["user_id", "name", "phone", "created_at", "submit_count"]);
    }
    if (detailsSheet.getLastRow() === 0) {
      detailsSheet.appendRow(["submit_id", "submitted_at", "user_id", "name", "phone", "brand", "type", "timeSlot", "area"]);
    }

    // === Normalize phone number ===
    var inputPhone = ("" + data.phone).trim().replace(/\D/g, ''); // Remove non-digit characters

    // === Check if phone exists in Users sheet ===
    var usersLastRow = usersSheet.getLastRow();
    var userExists = false;
    var userId, userRow, currentSubmitCount = 0;

    if (usersLastRow > 1) {
      var usersData = usersSheet.getRange(2, 1, usersLastRow - 1, usersSheet.getLastColumn()).getValues();
      
      for (var i = 0; i < usersData.length; i++) {
        var sheetPhone = ("" + usersData[i][2]).trim().replace(/\D/g, ''); // Normalize phone from sheet
        if (sheetPhone === inputPhone) {
          userExists = true;
          userId = usersData[i][0];   // Column A â†’ user_id
          userRow = i + 2;            // Actual row in sheet
          currentSubmitCount = usersData[i][4] || 0; // Column E â†’ submit_count
          break;
        }
      }
    }

    // === Create new user if phone not found ===
    if (!userExists) {
      // Count actual data rows (excluding header) for user ID generation
      var actualUserCount = Math.max(0, usersLastRow - 1);
      var newUserId = "user" + (100 + actualUserCount + 1);
      
      usersSheet.appendRow([
        newUserId, 
        data.name, 
        inputPhone, 
        formattedTime, 
        1  // Start with submit_count = 1
      ]);
      
      userId = newUserId;
      currentSubmitCount = 1;
      
    } else {
      // === For existing user: increment submit_count ===
      currentSubmitCount = currentSubmitCount + 1;
      usersSheet.getRange(userRow, 5).setValue(currentSubmitCount);
    }

    // === Add submission to UserDetails ===
    var detailsLastRow = detailsSheet.getLastRow();
    var actualDetailsCount = Math.max(0, detailsLastRow - 1);
    var newSubmitId = "sub" + (100 + actualDetailsCount + 1);
    
    detailsSheet.appendRow([
      newSubmitId,
      formattedTime,
      userId,
      data.name,
      inputPhone,
      data.brand || "",
      data.type || "",
      data.timeSlot || "",
      data.area || ""
    ]);

    return ContentService.createTextOutput(JSON.stringify({
      result: "success",
      message: userExists ? "Existing user - submission added" : "New user created",
      userId: userId,
      submitId: newSubmitId,
      isNewUser: !userExists,
      submissionCount: currentSubmitCount
    })).setMimeType(ContentService.MimeType.JSON);

  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({
      result: "error",
      message: error.toString()
    })).setMimeType(ContentService.MimeType.JSON);
  }
}




function doPost(e) {
  var data = e.parameter;
  var now = new Date();

  // Format date & unique short ID
  var dateStr = Utilities.formatDate(now, "Asia/Kolkata", "dd MMM yyyy, hh:mm:ss a");
  var dayLabel = Utilities.formatDate(now, "Asia/Kolkata", "dd MMM yyyy");
  var leadId = Math.random().toString(36).substring(2, 6).toUpperCase();

  // Subject (same for all leads of the same day â†’ goes into one thread)
  var subject = "ğŸ“… FixMyWasher Leads - " + dayLabel;

  // HTML email message
  var htmlMessage = `
    <html>
      <body style="font-family: Arial, sans-serif; background-color:#f4f6f8; padding:20px;">
        <div style="max-width:520px; margin:auto; background:#fff; padding:20px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.08);">
          
          <h3 style="color:#1565c0; text-align:center; margin-bottom:8px;">
            ğŸ†” ${leadId} â€” ğŸ§° New Washing Machine Repair Lead
          </h3>

          <p style="color:#555; text-align:center; font-size:13px; margin-top:0;">
            Youâ€™ve received a new customer request from your FixMyWasher website.
          </p>

          <table border="0" cellpadding="8" cellspacing="0" style="width:100%; font-size:14px; border-collapse:collapse; color:#333;">
            <tr><th align="left" style="background:#f7f9fc; width:40%;">ğŸ‘¤ <b>Name</b></th><td style="font-weight:bold;">${data.name || '-'}</td></tr>
            <tr><th align="left" style="background:#f7f9fc;">ğŸ“ <b>Phone</b></th><td style="font-weight:bold;"><a href="tel:${data.phone || ''}" style="color:#1976d2; text-decoration:none;">${data.phone || '-'}</a></td></tr>
            <tr><th align="left" style="background:#f7f9fc;">ğŸ·ï¸ <b>Brand</b></th><td style="font-weight:bold;">${data.brand || '-'}</td></tr>
            <tr><th align="left" style="background:#f7f9fc;">âš™ï¸ <b>Machine Type</b></th><td style="font-weight:bold;">${data.type || '-'}</td></tr>
            <tr><th align="left" style="background:#f7f9fc;">â° <b>Preferred Time</b></th><td style="font-weight:bold;">${data.timeSlot || '-'}</td></tr>
            <tr><th align="left" style="background:#f7f9fc;">ğŸ“ <b>Area</b></th><td style="font-weight:bold;">${data.area || '-'}</td></tr>
            <tr><th align="left" style="background:#f7f9fc;">ğŸ•’ <b>Submission Time</b></th><td style="font-weight:bold;">${dateStr}</td></tr>
          </table>

          <p style="color:#999; font-size:11px; text-align:center; margin-top:12px;">
            ğŸ“© This lead was submitted via your <b>FixMyWasher</b> website form.
          </p>
        </div>
      </body>
    </html>
  `;

  // Send to both recipients (same thread per day)
  var recipients = ["artisanapplianceservice@gmail.com", "ahmedsufi575@gmail.com"];
  for (var i = 0; i < recipients.length; i++) {
    MailApp.sendEmail({
      to: recipients[i],
      subject: subject,
      name: "ğŸ§° FixMyWasher",
      htmlBody: htmlMessage,
      replyTo: "FixMyWasher ğŸ§° <artisanapplianceservice@gmail.com>",
    });
  }

  return ContentService.createTextOutput("OK").setMimeType(ContentService.MimeType.TEXT);
}

1ï¸âƒ£ TV Not Turning On â€“ No power, TV completely dead
2ï¸âƒ£ Display Problem â€“ Screen blank, lines on screen, picture not visible
3ï¸âƒ£ Sound Problem â€“ No sound or sound not clear
4ï¸âƒ£ Remote / Buttons Not Working â€“ Remote not responding or TV buttons not working
5ï¸âƒ£ Wi-Fi / Connection Issue â€“ Internet not working, HDMI not detecting, apps not opening
6ï¸âƒ£ Screen Broken / Physical Damage â€“ Screen cracked or damaged due to fall

LED TV ( most common )
LCD TV 
OLED TV / QLED TV
Android TV /Smart TV
4K TV / HD TV
Curved TV 
NO idea no worries 


with this same content  and improve seo techniques in seo secction everthing create and change everthing with this page 
â”£ ğŸ“‚blog
 â”ƒ â”£ ğŸ“‚brand-specific
 â”ƒ â”ƒ â”£ ğŸ“œlg-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œmi-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œoneplus-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œpanasonic-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œsamsung-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œsony-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œthomson-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”— ğŸ“œvu-tv-repair-in-bangalore.html



tvrepairinbangalore
 â”£ ğŸ“‚blog
 â”ƒ â”£ ğŸ“‚area-specific
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-bannerghatta-road.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-bellandur.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-btm-layout.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-electronic-city.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-hsr-layout.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-indiranagar.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-jayanagar.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-koramangala.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-malleswaram.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-marathahalli.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-rajajinagar.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-sarjapur-road.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-repair-in-whitefield.html
 â”ƒ â”ƒ â”— ğŸ“œtv-repair-in-yelahanka.html
 â”ƒ â”£ ğŸ“‚brand-specific
 â”ƒ â”ƒ â”£ ğŸ“œlg-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œmi-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œoneplus-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œpanasonic-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œsamsung-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œsony-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œthomson-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”— ğŸ“œvu-tv-repair-in-bangalore.html
 â”ƒ â”£ ğŸ“‚issues-specific
 â”ƒ â”ƒ â”£ ğŸ“œtv-backlight-problems-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-power-issues-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-remote-not-working-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-screen-replacement-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-software-update-issues-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-sound-problems-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-standby-light-blinking-in-bangalore.html
 â”ƒ â”ƒ â”— ğŸ“œtv-wall-mounting-service-in-bangalore.html
 â”ƒ â”£ ğŸ“‚tv-type-specific
 â”ƒ â”ƒ â”£ ğŸ“œ4k-ultra-hd-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œandroid-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œlcd-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œled-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œoled-tv-repair-in-bangalore.html
 â”ƒ â”ƒ â”— ğŸ“œsmart-tv-repair-in-bangalore.html
 â”ƒ â”— ğŸ“œtv-repair-blog-bangalore.html
 â”£ ğŸ“‚images
 â”ƒ â”£ ğŸ“‚sideimages
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (1).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (10).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (11).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (12).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (13).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (14).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (15).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (2).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (3).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (4).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (5).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (6).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (7).png
 â”ƒ â”ƒ â”£ ğŸ“œsideimage (8).png
 â”ƒ â”ƒ â”— ğŸ“œsideimage (9).png
 â”ƒ â”£ ğŸ“œbrands.png
 â”ƒ â”£ ğŸ“œtv1.png
 â”ƒ â”£ ğŸ“œtv2.png
 â”ƒ â”£ ğŸ“œtv3.png
 â”ƒ â”£ ğŸ“œtv4.png
 â”ƒ â”— ğŸ“œtv5.png
 â”£ ğŸ“œabout.html
 â”£ ğŸ“œandroid-chrome-512x512.png
 â”£ ğŸ“œapple-touch-icon.png
 â”£ ğŸ“œcontact.html
 â”£ ğŸ“œdummy.html
 â”£ ğŸ“œfavicon.ico
 â”£ ğŸ“œindex.html
 â”£ ğŸ“œlogo2.png
 â”£ ğŸ“œprivacy-policy.html
 â”£ ğŸ“œsite.webmanifest
 â”£ ğŸ“œt.txt
 â”£ ğŸ“œterms-conditions.html
 â”£ ğŸ“œtestimonials.html
 â”— ğŸ“œtv-repair-near-me.html


 â”ƒ â”ƒ â”£ ğŸ“œtv-power-issues-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-remote-not-working-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-screen-replacement-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-software-update-issues-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-sound-problems-in-bangalore.html
 â”ƒ â”ƒ â”£ ğŸ“œtv-standby-light-blinking-in-bangalore.html
 â”ƒ â”ƒ â”— ğŸ“œtv-wall-mounting-service-in-bangalore.html



 now based on this page give with similar layout and section and give perfect and proper url for reaching use this layout and everthing dont change the header or footer size keep as it is and with this same content  and improve seo techniques in seo secction everthing else improve it add more content create and change everthing with this page and pls remove unnecessary margin top and bottom keep margin if need somewhere to show properly i dont want them create speciaclly for the mobile screen and put some space between the text and button for proper looking  google search console accepted and all the blocks sections will should there in 2 in one line good for mobile looking where necessary u decided it and dont menntion the price of the repair 
 â”ƒ â”£ ğŸ“‚issues-specific
 â”ƒ â”ƒ â”£ ğŸ“œtv-power-issues-in-bangalore.html